<h2>申請状況一覧</h2>
<div class="alert alert-danger">
  <% if @around_deadlines.present? %>
    <h4>本日(<%= Date.current %>)、申請処理期限が間近もしくは、過ぎている申請案件がありますので、申請処理者は速やかに対応願います！</h4>
    <table>
      <tr>
        <th>No</th>
        <th>幼稚園名</th>
        <th>申請認可名</th>
        <strong><th>申請処理期限</th></strong>
        <th>申請処理者</th>
      </tr>
      <% @around_deadlines.each.with_index(1) do |deadline, index| %>
      <tr>
        <td><%= index %></td>
        <td><%= deadline.name %>幼稚園</td>
        <td><%= deadline.title %></td>
        <td><%= deadline.processing_deadline %></td>
        <td><%= deadline.user.name %></td>
      </tr>
      <% end %>
    </table>
  <% end %>
</div>
<table>
  <tr>
    <th>
      <%= search_form_for @q do |f| %>
      <%= f.label :name, "学校名で検索(部分一致も可)" %>
      <%= f.search_field :name_cont %>
      <%= f.submit %>
      <% end %>
    </th>
    <th>
      <%= search_form_for @q do |f| %>
      <%= f.label :title, "申請名で検索(部分一致も可)" %>
      <%= f.search_field :title_cont %>
      <%= f.submit %>
      <% end %>
    </th>
  </tr>
</table>
<table>
  <tr>
    <th>No</th>
    <th><%= sort_link(@q, :name, "幼稚園名") %></th>
    <th><%= sort_link(@q, :title, "申請認可名") %></th>
    <th><%= sort_link(@q, :application_date, "申請日") %></th>
    <th><%= sort_link(@q, :processing_deadline, "申請処理期限") %></th>
    <th><%= sort_link(@q, :user_id, "申請処理者") %></th>
  </tr>
  <% @application_documents.each_with_index do |application_document, index| %>
  <tr>
    <td><%= index + 1 %></td>
    <td><%= application_document.name %>幼稚園</td>
    <td><%= application_document.title %></td>
    <td><%= application_document.application_date %></td>
    <td><%= application_document.processing_deadline %></td>
    <td><%= application_document.user.name %></td>
    <td><%= link_to t("link.Edit"), edit_application_document_path(application_document.id) if current_user.try(:admin?) || current_user.id == application_document.user_id %></td>
    <td><%= link_to t("link.Destroy"), application_document_path(application_document.id), method: :delete, data: { confirm: '本当に削除していいですか？' } if current_user.try(:admin?) || current_user.id == application_document.user_id %></td>
  </tr>
  <% end %>
</table>
<%= paginate @application_documents %>
<%= link_to '全件表示', application_documents_path %>
<%= link_to '申請登録へ', new_application_document_path %>
<%= link_to '幼稚園一覧へ', kindergartens_path %>
